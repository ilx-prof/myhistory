Non-Stop Copy v1.02
(C) Дмитрий Сергеев, 2004                mailto:dmitrys@nm.ru
Официальный сайт разработчика:           http://dmitrys.nm.ru



СИСТЕМНЫЕ ТРЕБОВАНИЯ

Windows NTx (NT4/2K/XP)
Конфигурация компьютера – любая, на которой способна запуститься 
указанная операционная система.
Windows 9x (95/98/ME) пока не поддерживается.



ОПИСАНИЕ

Программа позволяет копировать поврежденные файлы с любых носителей, 
причем не читаемые сектора заменяются нулевыми байтами. Также, 
пытается восстанавливать информацию из плохих секторов.
Программа не использует никаких низкоуровневых методов чтения 
информации, в результате чего будет корректно работать на любых типах 
носителей и на любых файловых системах, поддерживаемых операционной 
системой.
Процесс копирования файла разделен на 4 этапа: быстрое копирование, 
детализация, точная детализация, копирование плохих секторов. Цель 
этого разделения – за как можно меньшее время скопировать как можно 
больше хороших секторов, и на каждом этапе получать все более 
детальную картину плохих секторов.

Быстрое копирование. Копирует файл довольно большими блоками. Размер 
этого блока определяется опцией "Буфер быстрого копирования"; если 
включена опция "Авто", то буфер равен 1mb при копировании с быстрых 
носителей (CD, HDD), и 64kb при копировании с медленных носителей 
(FDD). Если внутри такого блока окажется плохой сектор, весь блок 
будет считаться плохим. В результате достигается быстрый пропуск групп 
плохих секторов и получается довольно приблизительная картина плохих 
участков файла.

Детализация. Каждый плохой сектор копирует по секторам до первого 
плохого сектора, сперва двигаясь от начала плохого блока, затем от 
конца плохого блока. В результате при малых затратах времени 
получается более точная картина групп плохих секторов.

Точная детализация. Пытается скопировать каждый сектор во всех плохих 
участках. По окончанию этого этапа получается реальная картина плохих 
секторов.	

Копирование плохих секторов. Пытается скопировать каждый плохой 
сектор, при этом делает подряд несколько попыток чтения. Количество 
попыток определяется опцией "Попыток скопировать плохой сектор". 
Именно на этом основана способность программы восстанавливать 
информацию из плохих секторов, так как в некоторых случаях (например 
старый, но не поцарапанный CD-R диск) есть вероятность, что сектор 
все-таки считается.

По умолчанию последний этап повторяется до тех пор, пока весь файл не 
будет успешно скопирован. Потому программа и называется – Non-Stop 
Copy. Но это поведение можно изменить с помощью опции "Макс. кол-во 
циклов 'плохого копирования'", которая определяет, сколько раз будет 
повторен последний этап.

В процессе копирования программа пытается контролировать время, 
которое будет затрачено на ту или иную операцию чтения. Размер этих 
временных интервалов устанавливается опциями в разделе "Таймауты 
чтения данных". Но к сожалению, иногда это не работает, например, на 
некоторых CD-ROMах. Причем это не является ошибкой программы, скорее 
это проблема или операционной системы или самого CD-ROMа.

Информация о копируемом файле и карта плохих секторов сохраняется в 
каталоге конечного файла в файле с тем же именем что и конечный файл с 
добавлением расширения ".nsc". Этот файл в программе называется 
информационный файл или инфофайл. Если копируемый файл полностью 
скопирован и не содержит плохих секторов, то инфофайл не сохраняется 
или удаляется, если был сохранен раньше. В процессе копирования 
инфофайл автоматически сохраняется с периодичностью, которая 
определяется опцией "Период автосохранения файла информации".



ОПЦИИ

«Буфер быстрого копирования» - определяет размер блока при быстром 
копировании. При включенной опции «Авто» это значение выбирается 
автоматически в зависимости от типа носителя, на котором расположен 
исходный файл (1mb при копировании с быстрых носителей (CD, HDD), и 
64kb при копировании с медленных носителей (FDD)).

«Попыток скопировать плохой сектор» - определяет количество попыток 
скопировать плохой сектор на этапе 'Копирование плохих секторов'.

«Макс. кол-во циклов 'плохого копирования'» - определяет, сколько раз 
будет повторен этап 'Копирование плохих секторов', при условии наличия 
плохих секторов. Если это значение равно 0, количество повторов не 
ограничено.

Раздел «Таймауты чтения данных» - значения в этом разделе определяют  
для каждого этапа через сколько миллисекунд будет отменена операция 
чтения, а считываемый участок файла помечен как плохой. Не увлекайтесь 
чрезмерным уменьшением этих значений, так как программа может начать 
помечать действительно читающиеся участки файла как плохие. 

«Период автосохранения файла информации» - определяет в миллисекундах, 
как часто в процессе копирования будет автоматически сохраняться 
инфофайл.

«Таймаут отмены процесса копирования» - определяет через сколько 
миллисекунд будет завершен поток копирования, в случае если он не 
реагирует на запрос пользователя об остановке копирования. Дело в том, 
что копирование происходит в отдельном потоке программы. Когда 
пользователь останавливает копирование, программа отдает потоку 
команду остановиться, но иногда, например при чтении плохих секторов 
на CD-ROM'ах, поток копирования ни на что не реагирует. В этом случае 
программа ждет указанное время, а затем прерывает работу потока. 
Однако, данная опция не определяет время, через которое в любом случае 
будет остановлено копирование, так как остановка не ограничивается 
только завершением потока копирования.



КОМАНДНАЯ СТРОКА

Программа поддерживает командную строку. Использование:
nscopy.exe [ИсходныйФайл] [КонечныйФайл] [/e] [/p] [/w] [/c]
или
nscopy.exe [<Файл или NSC инфо-файл> /i
где:
ИсходныйФайл - имя исходного (копируемого) файла
КонечныйФайл - имя конечного файла (куда копировать)
/e - выйти из программы после завершения копирования
/p - выключить компьютер после завершения копирования
/w - не начинать копирование сразу
/c - показать диалог выбора файла
/i - показать информацию по копируемому файлу



ДОПОЛНИТЕЛЬНО

Прочитайте файл "faq.txt", в нем вы можете найти некоторую полезную 
информацию.



ИЗВЕСТНЫЕ ПРОБЛЕМЫ

- Не работает TAB и ENTER в главном окне – просто пока этого не 
сделал.
- После остановки копирования во время одного из последних трех 
этапов, а затем возобновления, процесс начинается с начала файла. 
Тоже, просто пока этого не сделал, ввиду того, что большой надобности 
в этом нет. Даже наоборот - это позволяет пользователю слегка 
контролировать, какие плохие блоки читать.



ЧТО В БУДУЩЕМ

- поддержка Windows 9x
- поддержка файлов размером больше 4gb
- поддержка Unicode
- возможность создания патч-файлов

Если одна из этих возможностей реально вам понадобилась – напишите мне 
об этом. Возможно, это придаст мне стимул, и в следующей версии вы 
увидите то, что хотели. 



ИСТОРИЯ ВЕРСИЙ

1.02 (17/12/2004)
Первая публичная версия. До нее программа прошла целый ряд альфа 
версий, набралась стабильности.
